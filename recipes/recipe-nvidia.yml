---
# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
# image will be published to ghcr.io/<user>/<name>
name: buzzle-ublue-bluebuild
# description will be included in the image's metadata
description: Buzzle's ublue image.
alt-tags: 
  - nvidia

# the base image to build on top of (FROM) and the version tag to use
base-image: ghcr.io/ublue-os/base-main
image-version: latest # latest is also supported if you want new updates ASAP

# module configuration, executed in order
# you can include multiple instances of the same module
modules:
  - type: files
    files:
      - source: system
        destination: / # copies files/system/* (* means everything inside it) into your image's root folder /

  - type: dnf
    repos:
      copr:
        - atim/starship
        - ublue-os/staging
        - ublue-os/packages
        - che/nerd-fonts
        - gmaglione/podman-bootc
        - solopasha/hyprland
    install:
      packages:
        - micro
        - nano
        - flatpak
        - sddm
        - nerd-fonts
        - podman-bootc
        - podman-compose
        - podman-machine
        - podman-tui
        - podmansh
        - python3-pip
        - vulkan
        - hyprland
        - wofi
        - waybar
        - vifm
        - git
        - wireplumber
        - brightnessctl
        - playerctl
        - firewalld
        - network-manager-applet
        - hyprpaper
        - hyprlock
        - hypridle
        - blueman
        - polkit-kde
        - distrobox
        - grimshot
        - unzip
        - curl
        - plymouth
        - plymouth-plugin-script
        - fontawesome-fonts-all
        - ublue-brew
        - xdg-user-dirs
        - grubby
        - breeze-icon-theme
        - power-profiles-daemon
        - xdg-desktop-portal-hyprland
        - hyprland-plugins
        - hyprshot
        - hyprland-qtutils
        - gnome-keyring
        - tailscale
    # remove: {}

  - type: script
    scripts:
      - 40-nvidia.sh
      - 50-base-customizations.sh
      - 51-vscode.sh
      - 52-buzzle-dotfiles.sh

  - type: default-flatpaks@v2
    configurations: 
      - notify: true # Send notification after install/uninstall is finished (true/false)
        scope: system
        repo:
          title: Flathub (system)
        install:
          - com.github.tchx84.Flatseal
          - io.github.dvlv.boxbuddyrs
      - scope: user
        repo:
          title: Flathub (user)
  
  - type: kargs
    arch: x86_64, aarch64
    kargs:
      - quiet
      - splash

  - type: initramfs

  - type: os-release
    properties:
      ID: buzzle-ublue
      ID_LIKE: fedora
      NAME: BuzzleUblue
      PRETTY_NAME: Buzzle's ublue image - with Nvidia Drivers.

  - type: signing # this sets up the proper policy & signing files for signed images to work fully

